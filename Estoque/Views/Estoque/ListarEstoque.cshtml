@using DOMAIN.Model
@model List<EstoqueModel>
@{
	ViewData["Title"] = "Estoque produtos";

	decimal TotalGeralEstoque = Model.Sum(e => e.QuantidadeEstoque * (e.Produto?.ValorProduto) ?? 0);
}
@if (TempData["Sucesso"] != null)
{
	<p class="alert alert-success">@TempData["Sucesso"]</p>
}
@if (TempData["Erro"] != null)
{
	<p class="alert alert-danger">@TempData["Erro"]</p>
}

<div class="d-flex justify-content-between Titulo m-3">
	<h1>Estoque Produtos</h1>
	<a class="btn btn-primary fw-bold" asp-controller="Estoque" asp-action="CadastrarEstoque" style="height:45px">Adicionar Estoque</a>
</div>

<div class="d-flex gap-3 Entrada/Saida mb-2 mt-2">
	<a asp-controller="Estoque" asp-action="EntradaEstoque" class="btn btn-success fw-bold text-center" style="width:200px">Entrada</a>
	<a asp-controller="Estoque" asp-action="SaidaEstoque" class="btn btn-success fw-bold text-center" style="width:200px">Saida</a>
</div>

<table class="table">
	<thead>
		<tr class="table-dark">
			<th class="text-center" scope="col">Codigo</th>
			<th class="text-center" scope="col">Produto</th>
			<th class="text-center" scope="col">Quantidade</th>
			<th class="text-center" scope="col">Valor Total</th>
			<th class="text-center" scope="col">Opções</th>
		</tr>
	</thead>
	<tbody>
		@foreach (EstoqueModel e in Model)
		{
			decimal Subtotal = e.QuantidadeEstoque * (e.Produto?.ValorProduto ?? 0);
			<tr>
				<th class="text-center" scope="row">@e.CodigoEstoque</th>
				<td class="text-center">@e.Produto?.NomeProduto</td>
				<td class="text-center">@e.QuantidadeEstoque</td>
				<td class="text-center">@Subtotal.ToString("C")</td>
				<td class="text-center">
					<a asp-controller="Estoque" asp-action="DeletarEstoque" class="btn btn-danger fw-bold text-center" asp-route-codigo="@e.CodigoEstoque">Deletar</a>
				</td>
			</tr>
		}
	</tbody>
	<tfoot class="table-secondary">
		<tr>
			<td colspan="3" class="text-end fw-bold">VALOR TOTAL EM ESTOQUE:</td>
			<td class="text-center fw-bold " style="font-size: 1.1rem;">
				@TotalGeralEstoque.ToString("C")
			</td>
			<td></td> @* Coluna vazia para alinhar com 'Opções' *@
		</tr>
	</tfoot>
</table>


